<Window x:Class="GameClient.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="The World We Don't Know" Height="768" Width="1024"
        WindowStyle="None" ResizeMode="NoResize"  
        WindowStartupLocation="CenterScreen" WindowState="Maximized"
        xmlns:y="clr-namespace:GameClient.Converters"
        KeyDown="Grid_KeyDown" MouseDown="MainGrid_MouseDown" MouseMove="MainGrid_MouseMove">
        
    <Window.Resources>
        <y:GameObjectToSpriteConverter x:Key="GameObjectToSpriteConverter"/>
        <y:BlakeDebugConverter x:Key="BlakeDebugConverter"/>
        <y:RadToDegConverter x:Key="RadToDegConverter"/>
    </Window.Resources>
    <Window.Background>
        <ImageBrush ImageSource="Images\GameBackground.png"/>    
    </Window.Background>
    <Grid x:Name="MainGrid"  >
        <ItemsControl ItemsSource="{Binding Path=Manager.World.Objects}" Margin="-10,10,10,-10">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <Canvas/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Rectangle Width="{Binding Size.x}" Height="{Binding Size.y}" RenderTransformOrigin="0.5,0.5">
                        <Rectangle.Fill>
                            <ImageBrush Stretch="Fill" ImageSource="{Binding Converter={StaticResource GameObjectToSpriteConverter}}"/>
                        </Rectangle.Fill>                    
                        <Rectangle.RenderTransform>
                            <RotateTransform Angle="{Binding Angle}"/>
                        </Rectangle.RenderTransform>
                    </Rectangle>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
            <ItemsControl.ItemContainerStyle>
                <Style>
                    <Setter Property="Canvas.Left" Value="{Binding Position.x}"/>
                    <Setter Property="Canvas.Top" Value="{Binding Position.y}"/>
                </Style>
            </ItemsControl.ItemContainerStyle>
        </ItemsControl>

        <Button Height="50" Width="200" HorizontalAlignment="Right" Margin="0,267,27,167" Click="LevelUpButton" Focusable="False" Content="{Binding Path=CurrentController.CurrentCharacter.Position, Converter={StaticResource BlakeDebugConverter}}" />

        <Button Height="50" Width="200" HorizontalAlignment="Right" Click="TakeDamage" Margin="0,203,27,231" Focusable="False" Content="{Binding Path=CurrentController.CurrentCharacter.Velocity, Converter={StaticResource BlakeDebugConverter}}" />

        <Button Height="50" Width="200" HorizontalAlignment="Right" Click="GainExp" Margin="0,139,27,295" Focusable="False" Content="{Binding Path=CurrentController.CurrentCharacter.Heading, Converter={StaticResource BlakeDebugConverter}}" />

        <Button Height="50" Width="200" HorizontalAlignment="Right" Click="GainMoreExp" Margin="0,74,27,360" Focusable="False" Content="{Binding Path=CurrentController.CurrentCharacter.Angle, Converter={StaticResource BlakeDebugConverter}}" />

        <Button Height="50" Width="200" HorizontalAlignment="Right" Click="GainGold" Margin="0,10,27,424" Focusable="False" Content="{Binding Path=CurrentController.CurrentCharacter.Side, Converter={StaticResource BlakeDebugConverter}}" />

        <Canvas x:Name="ExperienceBar" Height="11" Width="580" VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="224,0,220,0" Background="Bisque" >

            <Rectangle x:Name="CurrentExperienceBar" VerticalAlignment="Top" HorizontalAlignment="Left" Width="323" Height="11" Fill="Gold"></Rectangle>
            <Label VerticalAlignment="Center" HorizontalAlignment="Center" Canvas.Left="256" Canvas.Top="-9">Experience</Label>
        </Canvas>


        <ItemsControl x:Name="OverLay" VerticalAlignment="Bottom" HorizontalAlignment="Right" BorderThickness="2" BorderBrush="Black" Width="250" Height="152">
            <ItemsControl.Background>
                <ImageBrush Stretch="None" ImageSource="Images\GameOverlay.jpg"/>
            </ItemsControl.Background>
            <Canvas Height="142" Margin="12,0,0,0">
                <Label Canvas.Top="-5">Str:</Label>
                <Label Canvas.Left="32" Width="68" Content="{Binding Path=CurrentController.CurrentCharacter.Strength}" Height="26" Canvas.Top="-5"></Label>

                <Label Canvas.Top="21">Def:</Label>
                <Label Canvas.Left="32" Canvas.Top="21" Width="68" Content="{Binding Path=CurrentController.CurrentCharacter.Defense}" Height="26"></Label>

                <Label Canvas.Top="47">Con:</Label>
                <Label Canvas.Left="32" Canvas.Top="47" Width="68" Content="{Binding Path=CurrentController.CurrentCharacter.Constitution}" Height="26"></Label>

                <Label Canvas.Top="73" Canvas.Left="-3">Health:</Label>
                <Label Canvas.Left="49" Canvas.Top="73" Width="51" RenderTransformOrigin="0.75,0.462" Content="{Binding Path=CurrentController.CurrentCharacter.Health}" Height="26"></Label>

                <Label Canvas.Left="100" Width="50">Gold:</Label>
                <Label Canvas.Left="154" Width="63" Content="{Binding Path=CurrentController.CurrentCharacter.Gold}"></Label>

                <Label Canvas.Left="100" Canvas.Top="26" Width="50" Height="32">Level</Label>
                <Label Content="{Binding Path=CurrentController.CurrentCharacter.Level}" Canvas.Left="154" Canvas.Top="26" Height="27" Width="53"></Label>

                <Label Canvas.Left="100" Canvas.Top="58" Width="50" Height="25">Exp:</Label>
                <Label Content="{Binding Path=CurrentController.CurrentCharacter.Experience}" Canvas.Left="150" Canvas.Top="58" Height="25" Width="36"></Label>
                <Label Canvas.Left="176" Canvas.Top="57">/</Label>
                <Label Content="{Binding Path=CurrentController.CurrentCharacter.ExperienceCap}" Canvas.Left="186" Canvas.Top="59" Height="24" Width="35"></Label>

                <Canvas x:Name="HealthBar" Height="26" Width="100" Canvas.Top="104" Background="Red">
                    <Rectangle x:Name="CurrentHealth" Height="26" Width="80" Fill="Green"/>
                </Canvas>
            </Canvas>
        </ItemsControl>
    </Grid>
</Window>
